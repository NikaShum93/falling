<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä Falling Words ‚Äî –ö–ì–ë</title>
  <style>
    body {
      font-family: 'Rubik', sans-serif;
      background: #0d0d0d;
      color: #f5f5f5;
      padding: 20px;
      margin: 0;
    }
    header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    header img {
      height: 50px;
    }
    header h1 {
      font-size: 1.8rem;
      color: #ffd700;
      margin: 0;
    }
    .level {
      border: 1px solid #333;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
      background: #1a1a1a;
      box-shadow: 0 0 10px rgba(255,215,0,0.2);
    }
    label { display: block; margin-top: 10px; }
    input, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      background: #111;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
      font-size: 1rem;
    }
    textarea { min-height: 80px; }
    .level button.remove {
      margin-top: 10px;
      padding: 6px 12px;
      background: #900;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .level button.remove:hover { background: #c00; }
    button#addLevel, button#saveBtn {
      margin-top: 20px;
      padding: 12px 18px;
      background: linear-gradient(90deg, #ffbf00, #ffd700);
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 1rem;
      color: #000;
      cursor: pointer;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px #ffd700;
    }
    #result {
      margin-top: 20px;
      height: 120px;
      background: #111;
      border: 1px solid #333;
      border-radius: 6px;
      color: #0f0;
      font-family: monospace;
      padding: 10px;
    }
    footer {
      margin-top: 30px;
      text-align: center;
      font-size: 0.9rem;
      color: #aaa;
    }
    footer a { color: #ffd700; text-decoration: none; }
    footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header>
    <a href="https://kgbgamecorp.ru" target="_blank">
      <img src="https://con.xl.ru/fnfLZuvpAUiDaqDs8d1-2g/images/kcJYv7OsYUSGt5AfGq5jIw.png" alt="–ö–ì–ë –õ–æ–≥–æ">
    </a>
    <h1>–†–µ–¥–∞–∫—Ç–æ—Ä –∏–≥—Ä—ã ¬´–ü–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞¬ª</h1>
  </header>

  <div id="levels"></div>

  <button id="addLevel">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
  <button id="saveBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å iframe</button>

  <textarea id="result" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è iframe –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ Genially"></textarea>

  <footer>
    ¬© 2025 <a href="https://kgbgamecorp.ru" target="_blank">–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ë—É–¥—É—â–µ–≥–æ</a>
  </footer>

<script>
function createLevelForm(index){
  const div=document.createElement("div");
  div.className="level";
  div.innerHTML=`
    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è / Target:
      <input class="target" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –±—É–∫–≤–∞ S –∏–ª–∏ Animals">
    </label>
    <label>–°–ª–æ–≤–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–µ, –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):
      <textarea class="items" placeholder="sun\nstar\nsnake\ndog\ncat"></textarea>
    </label>
    <label>–í—Ä–µ–º—è –Ω–∞ —É—Ä–æ–≤–µ–Ω—å (—Å–µ–∫—É–Ω–¥—ã):
      <input type="number" class="timer" value="30">
    </label>
    <button class="remove">–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
  `;
  div.querySelector(".remove").onclick=()=>div.remove();
  return div;
}

document.getElementById("addLevel").addEventListener("click",()=>{
  document.getElementById("levels").appendChild(createLevelForm());
});

// –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ä–∞–∑—É
document.getElementById("levels").appendChild(createLevelForm());

async function saveFalling(cfg) {
  const payload = { type: "falling", data: cfg };
  const res = await fetch("https://<—Ç–≤–æ–π-—Å–µ—Ä–≤–µ—Ä>.onrender.com/save", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });
  const data = await res.json();
  if (data.id) {
    const iframeCode = `<iframe src="https://nikashum93.github.io/falling/main.html?id=${data.id}" width="800" height="600" style="border:0;"></iframe>`;
    document.getElementById("result").value = iframeCode;
  } else {
    alert("–û—à–∏–±–∫–∞: " + (data.error || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"));
  }
}

function collectConfigFromForm(){
  const levels=[];
  document.querySelectorAll(".level").forEach(div=>{
    levels.push({
      target: div.querySelector(".target").value,
      items: div.querySelector(".items").value.split("\n").map(s=>s.trim()).filter(Boolean),
      timer: parseInt(div.querySelector(".timer").value,10) || 30
    });
  });
  return {levels};
}

document.getElementById("saveBtn").addEventListener("click",()=>{
  const cfg=collectConfigFromForm();
  saveFalling(cfg);
});
</script>
</body>
</html>
